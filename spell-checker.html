<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Modern Spell Checker</title>
<style>
  :root {
    --primary-color: #4285f4;
    --error-color: #d93025;
    --border-color: #dadce0;
    --bg-color: #ffffff;
    --text-color: #202124;
    --secondary-text: #5f6368;
  }
  
  body {
    font-family: 'Google Sans', Roboto, Arial, sans-serif;
    background-color: #f8f9fa;
    margin: 0;
    padding: 20px;
    color: var(--text-color);
    max-width: 800px;
    margin: 0 auto;
  }
  
  .container {
    background-color: var(--bg-color);
    border-radius: 8px;
    box-shadow: 0 1px 2px 0 rgba(60,64,67,0.3), 0 2px 6px 2px rgba(60,64,67,0.15);
    padding: 24px;
    margin-top: 20px;
  }
  
  h1 {
    color: var(--primary-color);
    font-size: 24px;
    font-weight: 400;
    margin: 0 0 20px 0;
  }
  
  #editor {
    width: 100%;
    min-height: 200px;
    border: 1px solid var(--border-color);
    border-radius: 4px;
    padding: 12px;
    font-size: 14px;
    line-height: 1.5;
    white-space: pre-wrap;
    outline: none;
    margin-bottom: 16px;
    transition: border 0.2s;
  }
  
  #editor:focus {
    border: 1px solid var(--primary-color);
  }
  
  .misspelled {
    text-decoration: underline wavy var(--error-color);
    text-decoration-thickness: 1px;
    text-underline-offset: 2px;
  }
  
  .toolbar {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 16px;
  }
  
  button {
    background-color: var(--primary-color);
    color: white;
    border: none;
    border-radius: 4px;
    padding: 8px 24px;
    font-size: 14px;
    cursor: pointer;
    height: 36px;
    transition: background-color 0.2s;
  }
  
  button:hover {
    background-color: #3367d6;
    box-shadow: 0 1px 2px 0 rgba(66,133,244,0.3);
  }
  
  button:disabled {
    background-color: #f1f3f4;
    color: #bdc1c6;
    cursor: default;
    box-shadow: none;
  }
  
  #status {
    font-size: 12px;
    color: var(--secondary-text);
    margin-top: 8px;
  }
  
  .word-count {
    font-size: 12px;
    color: var(--secondary-text);
  }
  
  .placeholder {
    color: #80868b;
    position: absolute;
    pointer-events: none;
    margin-top: -28px;
    margin-left: 12px;
  }
</style>
</head>
<body>

<div class="container">
  <h1>Spelling Checker</h1>
  
  <div class="toolbar">
    <div class="word-count" id="wordCount">0 words</div>
    <button id="scanBtn">
      <span id="buttonText">Check Spelling</span>
    </button>
  </div>
  
  <div id="editor" contenteditable="true" spellcheck="false" aria-label="Text editor"></div>
  <div class="placeholder" id="placeholder">Type or paste text here...</div>
  
  <div id="status">Ready</div>
</div>

<script>
const editor = document.getElementById('editor');
const scanBtn = document.getElementById('scanBtn');
const status = document.getElementById('status');
const wordCount = document.getElementById('wordCount');
const placeholder = document.getElementById('placeholder');
const buttonText = document.getElementById('buttonText');

// Whitelist: Common English words that are always treated as correct
const whitelist = new Set([
  "is", "the", "and", "a", "an", "in", "on", "at", "for", "to", "of", "by", "with", 
  "as", "it", "he", "she", "you", "we", "they", "that", "this", "these", "those",
  "are", "was", "were", "be", "been", "have", "has", "had", "do", "does", "did",
  "but", "or", "if", "so", "not", "no", "yes", "from", "my", "your", "our", "their",
  "i", "me", "him", "her", "us", "them", "his", "hers", "its", "mine", "yours", "theirs"
]);

// Common contractions
const contractions = new Set([
  "i'm", "you're", "he's", "she's", "it's", "we're", "they're", "i've", "you've",
  "we've", "they've", "i'd", "you'd", "he'd", "she'd", "we'd", "they'd", "i'll",
  "you'll", "he'll", "she'll", "we'll", "they'll", "isn't", "aren't", "wasn't",
  "weren't", "haven't", "hasn't", "hadn't", "don't", "doesn't", "didn't", "can't",
  "couldn't", "shouldn't", "wouldn't", "won't", "mustn't", "mightn't", "needn't"
]);

// Update word count and placeholder visibility
function updateUI() {
  const text = editor.innerText.trim();
  const words = text ? text.split(/\s+/).filter(word => word.length > 0) : [];
  wordCount.textContent = `${words.length} ${words.length === 1 ? 'word' : 'words'}`;
  placeholder.style.display = text.length ? 'none' : 'block';
}

editor.addEventListener('input', updateUI);
updateUI();

async function checkWord(word) {
  if (!word) return true;
  
  const lowerWord = word.toLowerCase();
  
  // Check whitelist and contractions
  if (whitelist.has(lowerWord) || contractions.has(lowerWord)) {
    return true;
  }
  
  // Remove common punctuation from the end
  const cleanWord = word.replace(/[.,?!;:']+$/, '');
  if (cleanWord.length === 0) return true;
  
  try {
    const response = await fetch(`https://api.dictionaryapi.dev/api/v2/entries/en/${cleanWord.toLowerCase()}`);
    if (response.ok) {
      return true;
    } else if (response.status === 404) {
      return false;
    }
    return true; // Assume correct on other status codes
  } catch (e) {
    console.error('API error:', e);
    return true; // Assume correct on error
  }
}

function escapeHtml(text) {
  const div = document.createElement('div');
  div.innerText = text;
  return div.innerHTML;
}

async function spellCheckText() {
  status.textContent = 'Checking spelling...';
  buttonText.textContent = 'Checking...';
  scanBtn.disabled = true;
  
  const text = editor.innerText;
  const words = text.split(/(\s+|\b)/); // split by word boundaries and whitespace
  
  // Check all words in parallel
  const checks = words.map(async (word) => {
    if (/^[a-zA-Z']+$/.test(word)) {
      const isValid = await checkWord(word);
      if (!isValid) {
        return `<span class="misspelled" data-word="${escapeHtml(word)}">${escapeHtml(word)}</span>`;
      }
    }
    return escapeHtml(word);
  });

  const results = await Promise.all(checks);
  editor.innerHTML = results.join('');
  
  status.textContent = 'Spell check complete';
  buttonText.textContent = 'Check Again';
  scanBtn.disabled = false;
  
  // Add click handler for misspelled words
  document.querySelectorAll('.misspelled').forEach(el => {
    el.addEventListener('click', (e) => {
      const word = e.target.getAttribute('data-word');
      // In a real app, you might show suggestions here
      console.log('Misspelled word clicked:', word);
    });
  });
}

scanBtn.addEventListener('click', spellCheckText);

// Allow pressing Enter in the editor instead of clicking the button
editor.addEventListener('keydown', (e) => {
  if (e.ctrlKey && e.key === 'Enter') {
    e.preventDefault();
    spellCheckText();
  }
});
</script>

</body>
</html>




